<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rubik's Cube Visual Solver</title>
  <style>
    body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin: 20px; }
    .cube-container { margin-top: 20px; font-family: monospace; white-space: pre; }
    button { margin: 5px; padding: 10px 15px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Rubik's Cube Visual Solver</h1>
  <div>
    <button onclick="scrambleCube()">Scramble</button>
    <button onclick="solveCube()">Solve</button>
    <button onclick="displayCube()">Show</button>
  </div>
  <div class="cube-container" id="cubeVisual"></div>

  <script>
    class RubiksCube {
      constructor(state = null) {
        this.state = state || 'wwwwwwwwwooooooooogggggggggrrrrrrrrrbbbbbbbbbyyyyyyyyy';
        this.history = [];
        this.scrambleSeq = [];
      }

      rotate(face) {
        this.history.push(face);
        const rotateFace = (indices) => {
          const s = this.state.split('');
          const tmp = indices.map(i => s[i]);
          [0,1,2,3,4,5,6,7,8].forEach((i, j) => {
            s[indices[i]] = tmp[[6,3,0,7,4,1,8,5,2][j]];
          });
          this.state = s.join('');
        };

        const rotateSides = {
          U: () => {
            rotateFace([0,1,2,3,4,5,6,7,8]);
            this.swap([36,37,38],[18,19,20],[9,10,11],[45,46,47]);
          },
          D: () => {
            rotateFace([27,28,29,30,31,32,33,34,35]);
            this.swap([42,43,44],[15,16,17],[24,25,26],[51,52,53]);
          },
          F: () => {
            rotateFace([18,19,20,21,22,23,24,25,26]);
            this.swap([6,7,8],[36,39,42],[27,28,29],[11,14,17], true);
          },
          B: () => {
            rotateFace([45,46,47,48,49,50,51,52,53]);
            this.swap([0,1,2],[9,12,15],[33,34,35],[38,41,44], true);
          },
          L: () => {
            rotateFace([36,37,38,39,40,41,42,43,44]);
            this.swap([0,3,6],[45,48,51],[27,30,33],[18,21,24], true);
          },
          R: () => {
            rotateFace([9,10,11,12,13,14,15,16,17]);
            this.swap([2,5,8],[20,23,26],[35,32,29],[47,50,53], true);
          }
        };
        rotateSides[face]?.();
      }

      swap(a, b, c, d, reverse = false) {
        const s = this.state.split('');
        const temp = a.map(i => s[i]);
        if (reverse) {
          a.forEach((v, i) => s[v] = s[d[i]]);
          d.forEach((v, i) => s[v] = s[c[i]]);
          c.forEach((v, i) => s[v] = s[b[i]]);
          b.forEach((v, i) => s[v] = temp[i]);
        } else {
          a.forEach((v, i) => s[v] = s[b[i]]);
          b.forEach((v, i) => s[v] = s[c[i]]);
          c.forEach((v, i) => s[v] = s[d[i]]);
          d.forEach((v, i) => s[v] = temp[i]);
        }
        this.state = s.join('');
      }

      scramble(moves = 10) {
        const faces = ['U', 'D', 'L', 'R', 'F', 'B'];
        let scrambleSeq = [];
        for (let i = 0; i < moves; i++) {
          const move = faces[Math.floor(Math.random() * faces.length)];
          this.rotate(move);
          scrambleSeq.push(move);
        }
        this.scrambleSeq = [...scrambleSeq];
        return scrambleSeq;
      }

      async solve() {
        for (let i = this.scrambleSeq.length - 1; i >= 0; i--) {
          const move = this.scrambleSeq[i];
          for (let j = 0; j < 3; j++) {
            this.rotate(move);
            displayCube();
            await new Promise(resolve => setTimeout(resolve, 300));
          }
        }
      }

      getCubeSvg() {
        return `<pre>${this.state.match(/.{9}/g).join('\n')}</pre>`;
      }
    }

    const cube = new RubiksCube();
    function displayCube() {
      document.getElementById("cubeVisual").innerHTML = cube.getCubeSvg();
    }
    function scrambleCube() {
      cube.scramble();
      displayCube();
    }
    async function solveCube() {
      await cube.solve();
    }

    displayCube();
  </script>
</body>
</html>
